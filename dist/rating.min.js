class FeedbackDialog{lightModeStyles={backgroundColor:"#f1f1f1",borderColor:"#ccc",textColor:"#333",starColor:"#ccc",starSelectedColor:"#ff9800",buttonBackgroundColor:"#007bff",buttonTextColor:"#fff",closeButtonBackgroundColor:"#ccc",closeButtonTextColor:"#333",checkboxTextColor:"#333"};darkModeStyles={backgroundColor:"#212121",borderColor:"#444",textColor:"#f1f1f1",starColor:"#666",starSelectedColor:"#ffcc00",buttonBackgroundColor:"#3E50B4",buttonTextColor:"#fff",closeButtonBackgroundColor:"#666",closeButtonTextColor:"#f1f1f1",checkboxTextColor:"#f1f1f1",linkTextColor:"#87cefa"};constructor(t,e,s={numberStars:5,minCharsAllowed:35,darkMode:!1}){t?t.ratingTitle||t.feedbackTitle||t.reasonTitle||t.nextButtonText||t.submitButtonText||t.thankYouMessage||t.closeButtonText?!t.reasons&&!t.selectReason||t.reasons||t.selectReason?!t.privacyOpts||!t.privacyOpts.text&&!t.privacyOpts.checked||t.privacyOpts.text||t.privacyOpts.checked?!t.optionalPage||!t.optionalPage.text&&!t.optionalPage.closeButtonText||t.optionalPage.text||t.optionalPage.closeButtonText?e?s.numberStars||s.minCharsAllowed||s.darkMode?s.numberStars<3?console.error("The total stars cannot be lower than 3!"):s.autoSubmitMinStars>s.numberStars?console.error("The number of stars cannot be lower than the auto submit minumum stars!"):(this.texts=t,this.submitCallback=e,this.privacyOpts=t.privacyOpts,this.settings=s,this.modeStyles=s.darkMode?this.darkModeStyles:this.lightModeStyles,this.createDialogue(),this.addEventListeners()):console.error("The minimum number of stars, the minimum number of characters or the dark mode is undefined!"):console.error("A submitCallback must be passed!"):console.error("Optional page data is incorrect!"):console.error("Privacy options are incorrect!"):console.error("Reasons are incorrect!"):console.error("Basic texts are not supplied!"):console.error("The texts cannot be empty!")}createDialogue(){this.createContainer(),this.createRatingStage(),this.createFeedbackStage(),this.texts.optionalPage&&this.createOptionalPage(),document.body.appendChild(this.dialogue),this.settings.darkMode&&document.querySelectorAll("a").forEach((t=>{t.style.color=this.darkModeStyles.linkTextColor}))}createContainer(){this.dialogue=document.createElement("div"),this.dialogue.style.backgroundColor=this.modeStyles.backgroundColor,this.dialogue.style.border=`1px solid ${this.modeStyles.borderColor}`,this.dialogue.style.color=this.modeStyles.textColor,this.dialogue.style.fontFamily=this.settings.fontFamily?this.settings.fontFamily:"Arial, Helvetica, sans-serif",this.dialogue.id=this.settings.id?this.settings.id:"feedbackDialogue",this.dialogue.style.position="fixed",this.dialogue.style.bottom=window.innerWidth<=768?"10px":"20px",this.dialogue.style.right=window.innerWidth<=768?"10px":"20px",this.dialogue.style.width=window.innerWidth<=768?"90%":"300px",this.dialogue.style.padding="10px",this.dialogue.style.boxShadow="0px 0px 10px rgba(0, 0, 0, 0.1)",this.dialogue.style.zIndex="1000",this.dialogue.style.borderRadius="5px"}createRatingStage(){this.ratingStage=document.createElement("div");const t=document.createElement("p");t.style.fontWeight="900",t.textContent=this.texts.ratingTitle,this.ratingStage.appendChild(t),this.stars=[];const e=`${this.settings.starSize?this.settings.starSize:48}px`;for(let t=1;t<=this.settings.numberStars;t++){const s=document.createElement("span");s.textContent="☆",s.style.fontSize=e,s.style.cursor="pointer",s.style.color=this.modeStyles.starColor,s.setAttribute("data-value",t),this.stars.push(s),this.ratingStage.appendChild(s)}this.closeButtonWrapper=document.createElement("div"),this.closeButtonWrapper.style.marginTop="10px",this.closeButtonWrapper.style.textAlign="right";const s=document.createElement("button");this.createBntStyle(s,this.texts.closeButtonText),s.addEventListener("click",(()=>{this.dialogue.remove()})),this.ratingStage.appendChild(this.closeButtonWrapper),this.closeButtonWrapper.appendChild(s),this.nextButtonWrapper=document.createElement("div"),this.nextButtonWrapper.style.marginTop="10px",this.nextButtonWrapper.style.textAlign="right",this.nextButtonWrapper.style.display="none",this.nextButton=document.createElement("button"),this.createBntStyle(this.nextButton,this.texts.nextButtonText),this.nextButtonWrapper.appendChild(this.nextButton),this.ratingStage.appendChild(this.nextButtonWrapper),this.dialogue.appendChild(this.ratingStage)}createBntStyle(t,e){t.textContent=e,t.style.padding="5px 10px",t.style.backgroundColor=this.modeStyles.buttonBackgroundColor,t.style.color=this.modeStyles.buttonTextColor,t.style.border="none",t.style.cursor="pointer",t.style.borderRadius="3px"}createFeedbackStage(){if(this.feedbackStage=document.createElement("div"),this.feedbackStage.style.display="none",this.texts.reasons){this.reasonTitle=document.createElement("p"),this.reasonTitle.textContent=this.texts.reasonTitle,this.reasonTitle.style.fontWeight="900",this.feedbackStage.appendChild(this.reasonTitle),this.reasonSelect=document.createElement("select"),this.reasonSelect.style.width="100%",this.reasonSelect.style.paddingTop="5px",this.reasonSelect.style.paddingBottom="10px",this.reasonSelect.style.borderRadius="3px",this.reasonSelect.style.border="1px solid #ccc",this.reasonSelect.style.marginBottom="10px";const t=document.createElement("option");t.value="",t.textContent=this.texts.selectReason,t.disabled=!0,t.selected=!0,this.reasonSelect.appendChild(t),this.texts.reasons.forEach((t=>{const e=document.createElement("option");e.value=t,e.textContent=t,this.reasonSelect.appendChild(e)})),this.feedbackStage.appendChild(this.reasonSelect)}const t=document.createElement("p");t.textContent=this.texts.feedbackTitle,t.style.fontWeight="900",this.feedbackStage.appendChild(t),this.feedbackTextArea=document.createElement("textarea"),this.feedbackTextArea.style.width="95%",this.feedbackTextArea.style.height="60px",this.feedbackTextArea.style.padding="5px",this.feedbackTextArea.style.borderRadius="3px",this.feedbackTextArea.style.border="1px solid #ccc",this.feedbackTextArea.style.resize="none",this.feedbackStage.appendChild(this.feedbackTextArea),this.privacyOpts&&(this.checkboxWrapper=document.createElement("div"),this.checkboxWrapper.style.marginTop="10px",this.checkboxWrapper.style.display="flex",this.checkboxWrapper.style.alignItems="center",this.checkboxInput=document.createElement("input"),this.checkboxInput.type="checkbox",this.checkboxInput.checked=this.privacyOpts.checked,this.checkboxInput.style.marginRight="5px",this.checkboxLabel=document.createElement("label"),this.checkboxLabel.innerHTML=this.privacyOpts.text,this.checkboxWrapper.appendChild(this.checkboxInput),this.checkboxWrapper.appendChild(this.checkboxLabel),this.feedbackStage.appendChild(this.checkboxWrapper),this.checkboxInput.addEventListener("change",this.validateInput.bind(this))),this.submitButtonWrapper=document.createElement("div"),this.submitButtonWrapper.style.marginTop="10px",this.submitButtonWrapper.style.textAlign="right",this.submitButton=document.createElement("button"),this.createBntStyle(this.submitButton,this.texts.submitButtonText),this.submitButtonWrapper.appendChild(this.submitButton),this.feedbackStage.appendChild(this.submitButtonWrapper),this.dialogue.appendChild(this.feedbackStage),this.validateInput()}addEventListeners(){this.stars.forEach(((t,e)=>{t.addEventListener("mouseover",(()=>this.handleStarHover(e))),t.addEventListener("click",(()=>this.handleStarClick(e)))})),this.nextButton.addEventListener("click",(()=>this.handleNextButtonClick())),this.feedbackTextArea.addEventListener("input",(()=>this.validateInput())),this.submitButton.addEventListener("click",(()=>this.handleSubmitFeedback())),this.texts.reasons&&this.reasonSelect.addEventListener("change",(()=>this.handleReasonSelectChange()))}handleAutoSubmit(t){this.submitCallback({selectedStars:t}),this.optionalStage?(this.ratingStage.style.display="none",this.optionalStage.style.display="block"):(alert(this.texts.thankYouMessage),this.dialogue.remove())}handleStarHover(t){this.stars.forEach(((e,s)=>{e.textContent=s<=t?"★":"☆",e.style.color=s<=t?"#ff9800":"#ccc"}))}handleStarClick(t){this.closeButtonWrapper.style.display="none",this.handleStarHover(t);const e=t+1;this.settings.autoSubmitMinStars&&e>=this.settings.autoSubmitMinStars?this.handleAutoSubmit(e):this.settings.showOnSamePage?this.feedbackStage.style.display="block":this.nextButtonWrapper.style.display="block",this.stars.forEach((t=>{const e=t.cloneNode(!0);t.parentNode.replaceChild(e,t)}))}handleNextButtonClick(){this.ratingStage.style.display="none",this.feedbackStage.style.display="block"}handleReasonSelectChange(){this.validateInput()}handleReasonFeedbackInput(){this.validateInput()}validateInput(){const t=this.submitButton;let e=!1,s=this.feedbackTextArea.value.length>=this.settings.minCharsAllowed;const i=!this.privacyOpts||this.checkboxInput.checked;this.texts.reasons&&(s=s&&this.reasonSelect.value),e=s&&i,e?(t.style.backgroundColor=this.modeStyles.buttonBackgroundColor,t.style.color=this.modeStyles.buttonTextColor,t.style.cursor="pointer",t.disabled=!1):(t.style.backgroundColor="#ccc",t.style.color="#666",t.style.cursor="not-allowed",t.disabled=!0)}createOptionalPage(){this.optionalStage=document.createElement("div"),this.optionalStage.style.display="none";const t=document.createElement("div");t.innerHTML=this.texts.optionalPage.text,this.optionalStage.appendChild(t);const e=document.createElement("button");this.createBntStyle(e,this.texts.optionalPage.closeButtonText),e.style.float="right",e.addEventListener("click",(()=>{this.dialogue.remove()})),this.optionalStage.appendChild(e),this.dialogue.appendChild(this.optionalStage)}handleSubmitFeedback(){const t=this.stars.filter((t=>"rgb(255, 152, 0)"===t.style.color)).length,e=this.feedbackTextArea.value;if("function"==typeof this.submitCallback)if(this.texts.reasons){const s=this.reasonSelect.value;this.submitCallback({rating:t,reason:s,feedback:e})}else this.submitCallback({rating:t,feedback:e});texts.optionalPage?(this.ratingStage.style.display="none",this.feedbackStage.style.display="none",this.optionalStage.style.display="block"):(alert(this.texts.thankYouMessage),this.dialogue.remove())}}